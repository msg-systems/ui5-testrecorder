/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/rta/command/BaseCommand','sap/ui/core/util/reflection/JsControlTreeModifier','sap/ui/fl/Utils'],function(B,J,f){"use strict";var C=B.extend("sap.ui.rta.command.ControlVariantSwitch",{metadata:{library:"sap.ui.rta",properties:{targetVariantReference:{type:"string"},sourceVariantReference:{type:"string"}},associations:{},events:{}}});C.prototype.MODEL_NAME="$FlexVariants";C.prototype._getAppComponent=function(e){var E=this.getElement();if(E){return e?f.getSelectorComponentForControl(E):f.getAppComponentForControl(E);}else{return this.getSelector().appComponent;}};C.prototype.execute=function(){var e=this.getElement(),c=this._getAppComponent(true),a=this._getAppComponent(),n=this.getTargetVariantReference();this.oModel=a.getModel(this.MODEL_NAME);this.sVariantManagementReference=J.getSelector(e,c).id;return this._updateModelVariant(n,c);};C.prototype.undo=function(){var o=this.getSourceVariantReference();var c=this._getAppComponent(true);return this._updateModelVariant(o,c);};C.prototype._updateModelVariant=function(v,c){if(this.getTargetVariantReference()!==this.getSourceVariantReference()){return Promise.resolve(this.oModel.updateCurrentVariant(this.sVariantManagementReference,v,c));}return Promise.resolve();};return C;},true);
