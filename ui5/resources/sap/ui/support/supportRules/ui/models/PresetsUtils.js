/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/support/supportRules/Storage","sap/ui/support/supportRules/Constants","sap/ui/support/supportRules/ui/models/SharedModel","sap/ui/core/util/File"],function(S,c,a,F){"use strict";var P={model:a,initializeSelectionPresets:function(s){if(this.model.getProperty("/persistingSettings")){var p=S.getSelectionPresets();if(p){this.model.setProperty("/selectionPresets",p);}}var b=this.model.getProperty("/selectionPresets");var o=null;b.some(function(C){if(C.selected){o=C;return true;}});if(o.isMySelection){o.selections=s;}this.model.setProperty("/selectionPresetsCurrent",o);},syncCurrentSelectionPreset:function(s){var p=this.model.getProperty("/selectionPresetsCurrent");p.selections=s;if(!(p.isModified||p.isMySelection)){p.isModified=true;p.title=p.title+" (*)";}this.model.setProperty("/selectionPresetsCurrent",p);if(P.isPersistingAllowed()){P.persistSelectionPresets();}},exportSelectionsToFile:function(i,t,d,s){var r={id:i,title:t,description:d,dateExported:(new Date()).toISOString(),version:"1.0",selections:s};var e=JSON.stringify(r);F.save(e,c.RULE_SELECTION_EXPORT_FILE_NAME,'json','text/plain');},isValidSelectionImport:function(I){var b=true;if(!I.hasOwnProperty("title")){b=false;}if(!I.hasOwnProperty("selections")){b=false;}else if(!Array.isArray(I.selections)){b=false;}else{for(var i=0;i<I.selections.length;i++){var r=I.selections[i];if(!r.hasOwnProperty("ruleId")||!r.hasOwnProperty("libName")){b=false;break;}}}return b;},persistSelectionPresets:function(){S.setSelectionPresets(this.model.getProperty("/selectionPresets"));},isPersistingAllowed:function(){return!!S.readPersistenceCookie(c.COOKIE_NAME);}};return P;});
