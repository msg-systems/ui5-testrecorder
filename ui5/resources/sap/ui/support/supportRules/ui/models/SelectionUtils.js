/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/support/supportRules/Constants","sap/ui/support/supportRules/Storage","sap/ui/support/supportRules/ui/models/SharedModel"],function(q,c,s,S){"use strict";var a={model:S,getRulesSelectionState:function(){var m=this.treeTable.getBinding().getModel(),r=m.getData(),b=[];Object.keys(r).forEach(function(R){r[R].nodes.forEach(function(o){b.push({ruleId:o.id,selected:o.selected,libName:o.libName});});});return b;},getSelectedRules:function(){var m=this.treeTable.getBinding().getModel(),r=m.getData(),b=[];if(!r){return;}Object.keys(r).forEach(function(R){r[R].nodes.forEach(function(o){if(o.selected){b.push({ruleId:o.id,libName:o.libName});}});});this.model.setProperty("/selectedRulesCount",b.length);return b;},updateSelectedRulesFromLocalStorage:function(t){var b=s.getSelectedRules();if(!b){return null;}if(!t){return null;}b.forEach(function(r){Object.keys(t).forEach(function(k){t[k].nodes.forEach(function(R){if(R.id===r.ruleId){R.selected=r.selected;if(!R.selected){t[k].selected=false;}}});});});return t;},persistSelection:function(){var b=this.getRulesSelectionState();s.setSelectedRules(b);},setSelectedRules:function(b){var t=this.model.getProperty("/treeModel");Object.keys(t).forEach(function(k){t[k].nodes.forEach(function(r){r.selected=false;});});b.forEach(function(r){Object.keys(t).forEach(function(k){t[k].nodes.forEach(function(R){if(R.id===r.ruleId){R.selected=true;}});});});this.treeTable.syncParentNoteWithChildrenNotes(t);this.treeTable.updateSelectionFromModel();this.getSelectedRules();if(s.readPersistenceCookie(c.COOKIE_NAME)){this.persistSelection();}},_syncSelectionAdditionalRuleSetsMainModel:function(t,T){Object.keys(t).forEach(function(k){Object.keys(T).forEach(function(k){if(t[k].id===T[k].id){t[k]=T[k];}});});return t;},_deselectAdditionalRuleSets:function(t,A){if(!A){return;}A.forEach(function(r){Object.keys(t).forEach(function(k){if(t[k].name===r){t[k].selected=false;t[k].nodes.forEach(function(R){R.selected=false;});}});});return t;}};return a;});
