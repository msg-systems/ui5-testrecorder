/*
 * ! UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/dt/plugin/DragDrop','sap/ui/dt/plugin/ElementMover','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayUtil'],function(D,E,a,O){"use strict";var C=D.extend("sap.ui.dt.plugin.ControlDragDrop",{metadata:{library:"sap.ui.dt",properties:{draggableTypes:{type:"string[]",defaultValue:["sap.ui.core.Element"]},elementMover:{type:"any"}},associations:{}}});var d="sapUiDtOverlayDropZone";C.prototype.init=function(){D.prototype.init.apply(this,arguments);this.setElementMover(new E());};C.prototype.setElementMover=function(n){var o=this.getElementMover();if(o!==n){if(o){o.destroy();}this.setProperty("elementMover",n);}};C.prototype.setDraggableTypes=function(b){this.getElementMover().setMovableTypes(b);return this.setProperty("draggableTypes",b);};C.prototype.registerElementOverlay=function(o){var e=o.getElement();if(this.getElementMover().isMovableType(e)&&this.getElementMover().checkMovable(o)&&!O.isInAggregationBinding(o,e.sParentAggregationName)){o.setMovable(true);}if(this.oDraggedElement){this.getElementMover().activateTargetZonesFor(o,d);}D.prototype.registerElementOverlay.apply(this,arguments);};C.prototype.deregisterElementOverlay=function(o){D.prototype.deregisterElementOverlay.apply(this,arguments);o.setMovable(false);if(this.oDraggedElement){this.getElementMover().deactivateTargetZonesFor(o,d);}};C.prototype.getDraggedOverlay=function(){return this._oDraggedOverlay;};C.prototype.onDragStart=function(o){this._oDraggedOverlay=o;this.getElementMover().setMovedOverlay(o);this.getElementMover().activateAllValidTargetZones(this.getDesignTime(),d);};C.prototype.onDragEnd=function(o){delete this._oPreviousTarget;this.getElementMover().deactivateAllTargetZones(this.getDesignTime(),d);delete this._oDraggedOverlay;this.getElementMover().setMovedOverlay(null);};C.prototype.onDragEnter=function(t){var o=this.getDraggedOverlay();if(t.getElement()!==o.getElement()&&t!==this._oPreviousTarget){this.getElementMover().repositionOn(o,t);}this._oPreviousTarget=t;};C.prototype.onAggregationDragEnter=function(A){delete this._oPreviousTarget;var o=this.getDraggedOverlay();this.getElementMover().insertInto(o,A);};return C;},true);
